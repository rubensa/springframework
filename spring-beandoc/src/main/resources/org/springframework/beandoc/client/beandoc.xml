<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>
    <description>
    	Bean factory definition for default beandoc setup
    </description>
    
    <bean id="processor" class="org.springframework.beandoc.DefaultContextProcessor">
    	<description>
    		main processor for generating output
    	</description>
    	<constructor-arg index="0" value="${input.files}"/>
     	<constructor-arg index="1" value="${output.dir}"/>
    	<property name="decorators">
    		<list>
    			<ref local="javadoc"/>
				<ref local="graphs"/>
    			<ref local="html"/> 
    		</list>
    	</property>
    	<property name="transformers">
    		<list>
    			<ref local="htmlIndexTransformer"/>
				<ref local="htmlNavigationTransformer"/>
    			<ref local="htmlMainTransformer"/> 
			    <ref local="htmlDocTransformer"/>    
			    <ref local="htmlImageMapMainTransformer"/>
			    <ref local="htmlImageMapTransformer"/>    
    			<ref local="dotFileTransformer"/>  
    		</list>
    	</property>    	    	
    	<property name="compilers">
    		<list>
				<ref local="compiler"/>
    		</list>
    	</property>    	
    </bean>   
    
	<bean id="javadoc" class="org.springframework.beandoc.output.JavaDocDecorator"/>			    
			    
	<bean id="graphs" class="org.springframework.beandoc.output.GraphVizDecorator" init-method="init"/>			    
			    
	<bean id="html" class="org.springframework.beandoc.output.HtmlDecorator"/>
	
	<bean id="i18n" abstract="true"/>
    
    <bean id="htmlIndexTransformer" class="org.springframework.beandoc.output.ConsolidatedTransformer">
	    <description>
	    	A consolidated transformer that creates the frameset document and whose stylesheet applies
	    	the user-configured documentation title
	    </description>
    	<property name="templateName" value="/org/springframework/beandoc/output/stylesheets/index.xsl"/>
    	<property name="filenameRoot" value="index"/>
    </bean>
    
    <bean id="htmlNavigationTransformer" parent="i18n" class="org.springframework.beandoc.output.ConsolidatedTransformer">
    	<property name="templateName" value="/org/springframework/beandoc/output/stylesheets/nav.xsl"/>
    	<property name="filenameRoot" value="nav"/>
    </bean>
    
    <bean id="htmlMainTransformer" parent="i18n" class="org.springframework.beandoc.output.ConsolidatedTransformer">
	    <description>
	    	Another consolidated transformer generating the main summary page.  Passes an XSL parameter to the
	    	stylesheet consisting of the current system time (documentation generation time)
	    </description>
    	<property name="templateName" value="/org/springframework/beandoc/output/stylesheets/main.xsl"/>
    	<property name="filenameRoot" value="main"/>
    	<property name="staticParameters">
			<map>
				<entry key="beandocGenerated">
					<bean parent="i18n" class="org.springframework.beandoc.util.LocalizedDateFactoryBean"/>
				</entry>
			</map>
		</property>
    </bean>
    
    <bean id="htmlImageMapMainTransformer" class="org.springframework.beandoc.output.ConsolidatedTransformer">
	    <description>
	    	Another consolidated transformer generating the main image map HTML skeleton
	    </description>
    	<property name="templateName" value="/org/springframework/beandoc/output/stylesheets/map-main.xsl"/>
    	<property name="filenameRoot" value="consolidated"/>
    	<property name="filenameStrategy">
            <bean class="org.springframework.beandoc.output.FilenameAppenderStrategy">
                <constructor-arg index="0" value=".xml.graph.html"/>
            </bean>
        </property>
    </bean>
    
    <bean id="htmlDocTransformer" parent="i18n" class="org.springframework.beandoc.output.XslTransformer">
    	<description>
	    	Transformer generating an HTML document for each input DOM.  A summary of beans followed by
	    	the detailed configuration of each follows.
	    </description>
    	<property name="templateName" value="/org/springframework/beandoc/output/stylesheets/doc.xsl"/>
    </bean>
    
    <bean id="htmlImageMapTransformer" class="org.springframework.beandoc.output.XslTransformer">
    	<description>
	    	Transformer generating an HTML document for each input DOM.  A placeholder for an image map is
	    	included that the HtmlCompiler will use to insert the generated image map over the graph.
	    </description>
    	<property name="templateName" value="/org/springframework/beandoc/output/stylesheets/map.xsl"/>
    	<property name="filenameStrategy"><ref local="graphHtmlStrategy"/></property>
    </bean>
      
	<bean id="dotFileTransformer" class="org.springframework.beandoc.output.DotFileTransformer">
		<property name="filenameStrategy"><ref local="dotStrategy"/></property>
	</bean>
	
	<bean id="compiler" class="org.springframework.beandoc.output.DocumentCompilerImpl">
		<property name="dotFileExtension" value=".dot"/>
    	<property name="filenameStrategy"><ref local="graphHtmlStrategy"/></property>
	</bean>

	<bean id="graphHtmlStrategy" class="org.springframework.beandoc.output.FilenameAppenderStrategy">
		<constructor-arg index="0" value=".graph.html"/>
	</bean>
	
	<bean id="dotStrategy" class="org.springframework.beandoc.output.FilenameAppenderStrategy">
		<constructor-arg index="0" value=".dot"/>
	</bean>
</beans>
