<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE webflow PUBLIC "-//SPRING//DTD WEBFLOW//EN"
	"http://www.springframework.org/dtd/spring-webflow.dtd">

<webflow id="upsrates" start-state="selectCustomerType">

	<view-state id="selectCustomerType" view="selectCustomer">
		<entry-action>
			<action bean="queryFormAction" method="setupForm"/>
		</entry-action>
		<transition to="bindCustomerType" on="submit"/>
	</view-state>
	
	<action-state id="bindCustomerType">
		<action bean="queryFormAction" method="bindAndValidate">
			<property name="validatorMethod" value="validateCustomerType"/>
		</action>
		<transition to="selectSender" on="success"/>
		<transition to="selectCustomerType" on="error">
			
		</transition>
	</action-state>

	<view-state id="selectSender" view="selectSender">
		<entry-action>
			<action class="org.springframework.webflow.samples.upsrates.web.LoadCountriesAction"/>
		</entry-action>
		<transition to="bindSender" on="submit"/>
	</view-state>
	
	<action-state id="bindSender">
		<action bean="queryFormAction" method="bindAndValidate">
			<property name="validatorMethod" value="validateSender"/>
		</action>
		<transition to="selectReceiver" on="success"/>
		<transition to="selectSender" on="error"/>
	</action-state>
	
	<view-state id="selectReceiver" view="selectReceiver">
		<entry-action>
			<action class="org.springframework.webflow.samples.upsrates.web.LoadCountriesAction"/>
		</entry-action>
		<transition to="bindReceiver" on="submit"/>
	</view-state>
	
	<action-state id="bindReceiver">
		<action bean="queryFormAction" method="bindAndValidate">
			<property name="validatorMethod" value="validateReceiver"/>
		</action>
		<transition to="selectPackageDetails" on="success"/>
		<transition to="selectReceiver" on="error"/>
	</action-state>
	
	<view-state id="selectPackageDetails" view="selectPackageDetails">
		<entry-action>
			<action class="org.springframework.webflow.samples.upsrates.web.LoadPackageDetailsDataAction" autowire="byType"/>
		</entry-action>
		<transition to="bindPackageDetails" on="submit"/>
	</view-state>
	
	<action-state id="bindPackageDetails">
		<action bean="queryFormAction" method="bindAndValidate">
			<property name="validatorMethod" value="validatePackageDetails"/>
		</action>
		<transition to="findRate" on="success"/>
		<transition to="selectPackageDetails" on="error"/>
	</action-state>
	
	<action-state id="findRate">
		<action bean="findUPSRateAction"/>
		<transition to="showRate" on="success"/>
		<transition to="selectPackageDetails" on="error"/>
	</action-state>
	
	<end-state id="showRate" view="showRate">
		<entry-action>
			<action class="org.springframework.webflow.samples.upsrates.web.LoadCountriesAction"/>
			<action class="org.springframework.webflow.samples.upsrates.web.ReferenceDataAction" autowire="byType"/>
		</entry-action>		
	</end-state>
	
</webflow>