<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE flow PUBLIC "-//SPRING//DTD WEBFLOW//EN"
	"http://www.springframework.org/dtd/spring-webflow-1.0.dtd">

<flow start-state="selectCustomerType">

	<view-state id="selectCustomerType" view="selectCustomer">
        <entry-actions>
			<action bean="queryFormAction" method="setupForm"/>
		</entry-actions>
        <transition to="bindCustomerType" on="submit"/>
	</view-state>
	
	<action-state id="bindCustomerType">
		<action bean="queryFormAction" method="bindAndValidate">
			<property name="validatorMethod" value="validateCustomerType"/>
		</action>
		<transition to="selectSender" on="success"/>
		<transition to="selectCustomerType" on="error">
			
		</transition>
	</action-state>

	<view-state id="selectSender" view="selectSender">
		<entry-actions>
			<action bean="loadCountriesAction"/>
		</entry-actions>
		<transition to="bindSender" on="submit"/>
	</view-state>
	
	<action-state id="bindSender">
		<action bean="queryFormAction" method="bindAndValidate">
			<property name="validatorMethod" value="validateSender"/>
		</action>
		<transition to="selectReceiver" on="success"/>
		<transition to="selectSender" on="error"/>
	</action-state>
	
	<view-state id="selectReceiver" view="selectReceiver">
		<entry-actions>
            <action bean="loadCountriesAction"/>
		</entry-actions>
		<transition to="bindReceiver" on="submit"/>
	</view-state>
	
	<action-state id="bindReceiver">
		<action bean="queryFormAction" method="bindAndValidate">
			<property name="validatorMethod" value="validateReceiver"/>
		</action>
		<transition to="selectPackageDetails" on="success"/>
		<transition to="selectReceiver" on="error"/>
	</action-state>
	
	<view-state id="selectPackageDetails" view="selectPackageDetails">
		<entry-actions>
            <action bean="loadCountriesAction"/>
		</entry-actions>
		<transition to="bindPackageDetails" on="submit"/>
	</view-state>
	
	<action-state id="bindPackageDetails">
		<action bean="queryFormAction" method="bindAndValidate">
			<property name="validatorMethod" value="validatePackageDetails"/>
		</action>
		<transition to="findRate" on="success"/>
		<transition to="selectPackageDetails" on="error"/>
	</action-state>
	
	<action-state id="findRate">
		<action bean="findUPSRateAction"/>
		<transition to="showRate" on="success"/>
		<transition to="selectPackageDetails" on="error"/>
	</action-state>
	
	<end-state id="showRate" view="showRate">
		<entry-actions>
            <action bean="loadCountriesAction"/>
			<action bean="referenceDataAction"/>
		</entry-actions>
	</end-state>
	
</flow>