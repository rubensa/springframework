<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE flow PUBLIC "-//SPRING//DTD WEBFLOW 1.0//EN"
	"http://www.springframework.org/dtd/spring-webflow.dtd">

<flow id="testFlow" start-state="actionState1">
	<property name="propInteger" value="12345" type="integer"/>
	
	<action-state id="actionState1">
		<property name="propBoolean" value="true" type="boolean"/>
		<property name="propString" value="aString"/>
		<action bean="action1">
			<property name="prop1"><value>prop1Value</value></property>
			<property name="prop2" value="prop2Value"/>
		</action>
		<action name="action2Name" bean="action2"/>
		<transition on="event1" to="viewState1">
			<property name="propBigDecimal" value="123.45" type="bigDecimal"/>
		</transition>
		<transition on="event2" to="actionState2"/>
		<transition on="action2Name.event2" to="viewState2"/>
	</action-state>

	<action-state id="actionState2">
		<action bean="action3" method="actionMethod"/>
		<transition on="success" to="viewState1"/>
	</action-state>

	<view-state id="viewState1" view="view1">
		<transition on="event1" to="subFlowState1"/>
	</view-state>
	
	<view-state id="viewState2">
		<entry-action>
			<action bean="action2"/>
		</entry-action>
		<transition on="event2" to="subFlowState2"/>
	</view-state>

	<subflow-state id="subFlowState1" flow="subFlow1">
		<attribute-mapper bean="attributeMapper1"/>
		<transition on="event1" to="endState1"/>
		<exit-action>
			<action bean="action2"/>
		</exit-action>
	</subflow-state>

	<subflow-state id="subFlowState2" flow="subFlow2">
		<attribute-mapper>
			<input name="attribute1"/>
			<input name="attribute3" as="attribute2"/>
			<input value="${flowScope.attribute1}" as="attribute4"/>
			<output name="attribute2"/>
			<output name="attribute1" as="attribute3"/>
			<output value="${flowScope.attribute4}" as="attribute1"/>
		</attribute-mapper>
		<transition on="event2" to="endState2"/>
	</subflow-state>
	
	<end-state id="endState1" view="endView1"/>
	
	<end-state id="endState2"/>

	<exception-handler on="org.springframework.webflow.config.MyCustomException" to="endState1"/>
	<exception-handler bean="myCustomHandler"/>
	
	<bean id="action1" class="org.springframework.webflow.config.XmlFlowBuilderTests$TestAction"/>
	<bean id="action3" class="org.springframework.webflow.config.XmlFlowBuilderTests$TestMultiAction"/>
	<bean id="myCustomHandler" class="org.springframework.webflow.config.MyCustomStateExceptionHandler"/>
	
</flow> 