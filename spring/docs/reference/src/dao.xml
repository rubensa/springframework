<?xml version="1.0" encoding="UTF-8" ?>
<chapter id="dao">
	<title>DAO support</title>
	<section id="dao-introduction">
		<title>Introduction</title>
		<para>
			The Data Access Object (DAO) support in Spring is primarily aimed at
			making it easy to work with data access technologies like JDBC, Hibernate
			or JDO in a standardized way. This allows one to switch between the
			aforementioned persistence technologies fairly easily and it also allows
			one to code without worrying about catching exceptions that are specific 
			to each technology.
		</para>
	</section>
	<section id="dao-exceptions">
		<title>Consistent exception hierarchy</title>
		<para>
			Spring provides a convenient translation from technology specific
			exceptions like <classname>SQLException</classname> to its own exception
			hierarchy with the <classname>DataAccessException</classname> as the root
			exception. These exceptions wrap the original exception so there is never
			any risk that one might lose any information as to what might have gone
			wrong.
		</para>
		<para>
			In addition to JDBC exceptions, Spring can also wrap Hibernate-specific
			exceptions, converting them from proprietary, checked exceptions (in the
			case of versions of Hibernate prior to Hibernate 3.0), to a set of
			abstracted runtime exceptions (the same is true for JDO exceptions).
			This allows one to handle most persistence exceptions, which are
			non-recoverable, only in the appropriate layers, without annoying
			boilerplate catch and throw blocks, and exception declarations. (One can
			still trap and handle exceptions anywhere one needs to though.) As
			mentioned above, JDBC exceptions (including database-specific dialects)
			are also converted to the same hierarchy, meaning that one can perform
			some operations with JDBC within a consistent programming model.
		</para>
		<para>
			The above holds true for the various template-based versions of the ORM access
			framework. If one uses the interceptor-based classes then the application
			must care about handling <classname>HibernateException</classname>s and
			<classname>JDOException</classname>s itself, preferably via delegating to
			<classname>SessionFactoryUtils</classname>'
			<literal>convertHibernateAccessException</literal> or
			<literal>convertJdoAccessException</literal> methods respectively. These
			methods convert the exceptions to ones that are compatible with the
			<literal>org.springframework.dao</literal> exception hierarchy. As
			<classname>JDOException</classname>s are unchecked, they can simply get thrown
			too, sacrificing generic DAO abstraction in terms of exceptions though.
		</para>
		<para>
			The exception hierarchy that Spring uses is outlined in the following image:
		</para>
		<mediaobject>
			<imageobject>
				<imagedata fileref="images/DataAccessException.gif" />
			</imageobject>
		</mediaobject>
		<para>
			(Please note that the class hierarchy detailed in the above image shows only
			a subset of the whole, rich, <classname>DataAccessException</classname> hierarchy.)
		</para>
	</section>
	<section>
		<title>Consistent abstract classes for DAO support</title>
		<para>
			To make it easier to work with a variety of data access technologies
			such as JDBC, JDO and Hibernate in a consistent way, Spring provides a set of
			abstract DAO classes that one can extend. These abstract classes have
			methods for providing the data source and any other configuration settings
			that are specific to the technology one currently is using.
		</para>
		<para>Dao support classes:</para>
		<itemizedlist>
			<listitem>
				<para>
					<classname>JdbcDaoSupport</classname> - super class for JDBC data
					access objects. Requires a <interfacename>DataSource</interfacename>
					to be provided; in turn, this class provides a 
					<classname>JdbcTemplate</classname> instance initialized from the
					supplied <interfacename>DataSource</interfacename> to subclasses.
				</para>
			</listitem>
			<listitem>
				<para>
					<classname>HibernateDaoSupport</classname> - super class for
					Hibernate data access objects. Requires a
					<interfacename>SessionFactory</interfacename> to be provided;
					in turn, this class provides a 
					<classname>HibernateTemplate</classname> instance initialized from the
					supplied <interfacename>SessionFactory</interfacename> to subclasses. Can
					alternatively be initialized directly via a
					<classname>HibernateTemplate</classname>, to reuse the latter's settings
					like <interfacename>SessionFactory</interfacename>, flush mode, exception
					translator, etc.
				</para>
			</listitem>
			<listitem>
				<para>
					<classname>JdoDaoSupport</classname> - super class for JDBC data
					access objects. Requires a <interfacename>PersistenceManagerFactory</interfacename>
					to be provided; in turn, this class provides a 
					<classname>JdoTemplate</classname> instance initialized from the
					supplied <interfacename>PersistenceManagerFactory</interfacename> to
					subclasses.
				</para>
			</listitem>
			<listitem>
				<para>
					<classname>JpaDaoSupport</classname> - super class for JPA data
					access objects. Requires a <interfacename>EntityManagerFactory</interfacename>
					to be provided; in turn, this class provides a 
					<classname>JpaTemplate</classname> instance initialized from the
					supplied <interfacename>EntityManagerFactory</interfacename> to
					subclasses.
				</para>
			</listitem>
		</itemizedlist>
	</section>
</chapter>